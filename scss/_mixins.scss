/** @project: Kat UI Framework */
/** @author: Bui Van Tai, 2024-12-15, Mixins and utility functions for Kat UI */

// Media query mixins
@mixin kat-screen-sm {
  @media (min-width: #{$kat-breakpoint-sm}) {
    @content;
  }
}

@mixin kat-screen-md {
  @media (min-width: #{$kat-breakpoint-md}) {
    @content;
  }
}

@mixin kat-screen-lg {
  @media (min-width: #{$kat-breakpoint-lg}) {
    @content;
  }
}

@mixin kat-screen-xl {
  @media (min-width: #{$kat-breakpoint-xl}) {
    @content;
  }
}

@mixin kat-screen-2xl {
  @media (min-width: #{$kat-breakpoint-2xl}) {
    @content;
  }
}

// Focus styles mixin
@mixin kat-focus-ring {
  outline: 2px solid transparent;
  outline-offset: 2px;
  
  &:focus-visible {
    box-shadow: $kat-focus-ring-offset-shadow, $kat-focus-ring;
  }
}

// Button base styles
@mixin kat-button-base {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: $kat-radius-md;
  font-weight: $kat-font-weight-medium;
  transition: all $kat-duration-250 $kat-ease-apple;
  cursor: pointer;
  border: $kat-border-1 solid transparent;
  text-decoration: none;
  white-space: nowrap;
  
  @include kat-focus-ring;
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  svg {
    flex-shrink: 0;
  }
}

// Button sizes
@mixin kat-button-xs {
  height: 1.5rem;
  padding: 0 $kat-space-2;
  font-size: $kat-font-size-xs;
  gap: $kat-space-1;
}

@mixin kat-button-sm {
  height: 2rem;
  padding: 0 $kat-space-3;
  font-size: $kat-font-size-sm;
  gap: $kat-space-1-5;
}

@mixin kat-button-base-size {
  height: 2.5rem;
  padding: 0 $kat-space-4;
  font-size: $kat-font-size-sm;
  gap: $kat-space-2;
}

@mixin kat-button-lg {
  height: 3rem;
  padding: 0 $kat-space-6;
  font-size: $kat-font-size-base;
  gap: $kat-space-2;
}

// Card base styles
@mixin kat-card-base {
  background-color: $kat-white;
  border: $kat-border-1 solid $kat-gray-200;
  border-radius: $kat-radius-lg;
  box-shadow: $kat-shadow-sm;
}

// Input base styles
@mixin kat-input-base {
  width: 100%;
  border: $kat-border-1 solid $kat-gray-300;
  border-radius: $kat-radius-md;
  padding: $kat-space-2-5 $kat-space-3;
  font-size: $kat-font-size-sm;
  line-height: $kat-line-height-normal;
  background-color: $kat-white;
  color: $kat-gray-900;
  transition: all $kat-duration-200 $kat-ease-apple;
  
  @include kat-focus-ring;
  
  &::placeholder {
    color: $kat-gray-400;
  }
  
  &:hover {
    border-color: $kat-gray-400;
  }
  
  &:focus {
    border-color: $kat-primary-600;
    box-shadow: $kat-focus-ring-offset-shadow, 0 0 0 3px $kat-primary-200;
    background-color: $kat-primary-25;
    transform: scale(1.005);
    outline: none;
  }
  
  &:disabled {
    background-color: $kat-gray-100;
    color: $kat-gray-500;
    cursor: not-allowed;
  }
}

// Screen reader only
@mixin kat-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

// Clearfix
@mixin kat-clearfix {
  &::after {
    content: "";
    display: table;
    clear: both;
  }
}

// Flex center
@mixin kat-flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

// Aspect ratio
@mixin kat-aspect-ratio($ratio: 1) {
  aspect-ratio: $ratio;
  
  @supports not (aspect-ratio: 1) {
    &::before {
      content: "";
      float: left;
      padding-top: calc(100% / #{$ratio});
    }
    
    &::after {
      content: "";
      display: table;
      clear: both;
    }
  }
}

// Visually hidden but accessible
@mixin kat-visually-hidden {
  @include kat-sr-only;
}

// Truncate text
@mixin kat-truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

// Line clamp
@mixin kat-line-clamp($lines: 2) {
  display: -webkit-box;
  -webkit-line-clamp: $lines;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

// Hover and focus states
@mixin kat-hover {
  @media (hover: hover) {
    &:hover {
      @content;
    }
  }
}

// Animation keyframes for common patterns
@keyframes kat-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes kat-pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

@keyframes kat-bounce {
  0%, 100% {
    transform: translateY(-25%);
    animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
  }
  50% {
    transform: translateY(0);
    animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
  }
}

// Scrollbar styling
@mixin kat-scrollbar {
  &::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  
  &::-webkit-scrollbar-track {
    background: $kat-gray-100;
    border-radius: $kat-radius-base;
  }
  
  &::-webkit-scrollbar-thumb {
    background: $kat-gray-300;
    border-radius: $kat-radius-base;
    
    &:hover {
      background: $kat-gray-400;
    }
  }
  
  /* Firefox */
  scrollbar-width: thin;
  scrollbar-color: $kat-gray-300 $kat-gray-100;
}

// Shadow mixins
@mixin kat-elevation-1 {
  box-shadow: $kat-shadow-sm;
}

@mixin kat-elevation-2 {
  box-shadow: $kat-shadow;
}

@mixin kat-elevation-3 {
  box-shadow: $kat-shadow-md;
}

@mixin kat-elevation-4 {
  box-shadow: $kat-shadow-lg;
}

@mixin kat-elevation-5 {
  box-shadow: $kat-shadow-xl;
}